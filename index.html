<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CSE 60-F | CR Dashboard Pro</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
/* ================= ROOT ================= */
:root{
--primary:#0f172a;
--secondary:#1e293b;
--accent:#f97316;
--bg:#f8fafc;
--glass:rgba(255,255,255,.85);
--green:#10b981;
--red:#ef4444;
--blue:#3b82f6;
--shadow:0 10px 15px -3px rgba(0,0,0,.1);
}
body{
margin:0;
font-family:Inter,sans-serif;
background:linear-gradient(135deg,#f1f5f9,#e2e8f0);
color:#334155;
display:flex;
flex-direction:column;
align-items:center;
padding-bottom:40px;
}
/* ================= HEADER ================= */
header{
width:100%;
background:var(--primary);
color:#fff;
padding:28px 0;
text-align:center;
border-bottom:4px solid var(--accent);
}
header h1{margin:0;font-size:1.7rem}
#live-date{opacity:.8;font-size:.9rem}
/* ================= CARD ================= */
.card{
width:92%;
max-width:700px;
background:var(--glass);
backdrop-filter:blur(10px);
padding:25px;
border-radius:20px;
margin:15px 0;
box-shadow:var(--shadow);
text-align:center;
}
.timer{
font-size:2.4rem;
font-weight:800;
background:#f1f5f9;
padding:6px 20px;
border-radius:12px;
display:inline-block;
}
/* ================= NOTICE ================= */
.notice-bar{
width:92%;
max-width:700px;
background:#fff7ed;
border-left:5px solid var(--accent);
padding:15px;
border-radius:10px;
display:none;
box-shadow:var(--shadow);
}
/* ================= NAV ================= */
.nav-grid{
width:92%;
max-width:700px;
display:grid;
grid-template-columns:repeat(2,1fr);
gap:12px;
}
.btn{
padding:14px;
border:none;
border-radius:12px;
color:#fff;
font-weight:600;
cursor:pointer;
}
.btn-routine{background:var(--primary)}
.btn-teacher{background:var(--secondary)}
.btn-att{background:var(--green)}
.btn-edit{background:#64748b}
/* ================= TASK ================= */
.task-item{
background:#fff;
padding:15px;
border-radius:12px;
margin-bottom:12px;
border-left:5px solid;
}
.task-type-ct{border-color:var(--red)}
.task-type-assign{border-color:var(--blue)}
.task-type-lab{border-color:var(--green)}
/* ================= TABLE ================= */
.content-section{display:none;width:95%;max-width:1000px}
table{
width:100%;
border-collapse:collapse;
background:#fff;
border-radius:15px;
overflow:hidden;
}
th{
background:var(--primary);
color:#fff;
padding:12px;
}
td{
padding:12px;
border-bottom:1px solid #e2e8f0;
text-align:center;
}
.lab-highlight{background:#ecfdf5;font-weight:700}
/* ================= ATT ================= */
.id-grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(60px,1fr));
gap:10px;
}
.id-btn{
border:2px solid #e2e8f0;
border-radius:10px;
padding:10px;
cursor:pointer;
font-weight:700;
}
.id-btn.present{
background:var(--green);
color:#fff;
}
textarea,input,select{
width:100%;
padding:10px;
border-radius:10px;
border:1px solid #e2e8f0;
margin-bottom:10px;
}
</style>
</head>

<body>

<header>
<h1>CSE Batch 60-F Dashboard</h1>
<div id="live-date"></div>
</header>

<div id="notice-bar" class="notice-bar">
<div id="notice-text-display"></div>
</div>

<div class="card">
<div style="color:var(--accent);font-weight:700">Upcoming Session</div>
<div id="next-class-name"></div>
<div id="countdown-timer" class="timer">00h 00m 00s</div>
</div>

<div id="active-tasks-container" class="card" style="display:none">
<h3>ðŸ“¢ Upcoming Tasks</h3>
<div id="task-board"></div>
</div>

<div class="nav-grid">
<button class="btn btn-routine" onclick="show('full-table')">Routine</button>
<button class="btn btn-teacher" onclick="show('teacher-info')">Teachers</button>
<button class="btn btn-att" onclick="protectedShow('attendance-section')">Attendance</button>
<button class="btn btn-edit" onclick="protectedShow('edit-panel')">Settings</button>
</div>

<!-- ================= CONTENT ================= -->
<div id="attendance-section" class="content-section">
<div class="card">
<h3>Attendance</h3>
<div class="id-grid" id="id-container"></div>
<textarea id="attendance-output" rows="5" readonly></textarea>
</div>
</div>

<div id="teacher-info" class="content-section">
<div id="teacher-list"></div>
</div>

<div id="full-table" class="content-section">
<table>
<thead>
<tr><th>Time</th><th>Sat</th><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th></tr>
</thead>
<tbody id="routine-body"></tbody>
</table>
</div>

<div id="edit-panel" class="content-section">
<div class="card" style="text-align:left">
<h3>CR Control Panel</h3>

<select id="task-type">
<option value="CT">Quiz / CT</option>
<option value="Assignment">Assignment</option>
<option value="Lab">Lab</option>
</select>

<input type="date" id="task-date">
<input type="time" id="task-time">
<input placeholder="Topic" id="task-topic">
<textarea placeholder="Description" id="task-desc"></textarea>

<button class="btn btn-att" onclick="addNewTask()">Add Task</button>

<hr>
<textarea id="json-teachers" placeholder="Teachers JSON"></textarea>
<textarea id="json-classes" placeholder="Routine JSON"></textarea>
<textarea id="notice-text" placeholder="Notice"></textarea>

<button class="btn btn-routine" onclick="saveData()">Save All</button>
</div>
</div>

<script>
/* ================= FIREBASE ================= */
firebase.initializeApp({
apiKey:"AIzaSyDi6GkHtLaMqIQIQXkEk9g80iQmFrCyqs",
authDomain:"cse-60f-dashboard-56f50.firebaseapp.com",
databaseURL:"https://cse-60f-dashboard-56f50-default-rtdb.firebaseio.com"
});
const db=firebase.database();
const ref=db.ref("dashboardData");

/* ================= GLOBAL ================= */
const PASSWORD="1322";
let appData=null;
let presentIDs=[];

/* ================= LOAD ================= */
ref.on("value",snap=>{
appData=snap.val();
renderAll();
});

/* ================= FUNCTIONS ================= */
function protectedShow(id){
if(prompt("Password?")===PASSWORD) show(id);
else alert("Wrong password");
}
function show(id){
document.querySelectorAll(".content-section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
if(id==="attendance-section") initAttendance();
if(id==="edit-panel"){
json_teachers.value=JSON.stringify(appData.teachers,null,2);
json_classes.value=JSON.stringify(appData.classes,null,2);
notice_text.value=appData.noticeText||"";
}
}
function renderAll(){
renderTasks();
renderTeachers();
renderRoutine();
if(appData.noticeText){
notice_bar.style.display="block";
notice_text_display.innerText=appData.noticeText;
}
}
function addNewTask(){
const t={id:Date.now(),
type:task_type.value,
date:task_date.value,
time:task_time.value,
topic:task_topic.value,
desc:task_desc.value};
if(!t.date||!t.topic) return alert("Required!");
appData.tasks.push(t);
ref.set(appData);
}
function renderTasks(){
task_board.innerHTML="";
if(!appData.tasks.length){active_tasks_container.style.display="none";return;}
active_tasks_container.style.display="block";
appData.tasks.forEach(t=>{
const d=document.createElement("div");
d.className=`task-item task-type-${t.type==="CT"?"ct":t.type==="Assignment"?"assign":"lab"}`;
d.innerHTML=`<b>${t.type}</b> | ${t.topic}<br>${t.date}`;
task_board.appendChild(d);
});
}
function renderTeachers(){
teacher_list.innerHTML=appData.teachers.map(t=>`
<div class="card"><b>${t.name}</b><br>${t.courses}</div>
`).join("");
}
function renderRoutine(){
routine_body.innerHTML="";
}
/* ================= ATT ================= */
function initAttendance(){
id_container.innerHTML="";
let ids=JSON.parse(localStorage.getItem("ids"))||[50,52];
ids.forEach(i=>{
const b=document.createElement("button");
b.className="id-btn"+(presentIDs.includes(i)?" present":"");
b.innerText=i;
b.onclick=()=>{presentIDs.includes(i)?presentIDs=presentIDs.filter(x=>x!==i):presentIDs.push(i);initAttendance()};
id_container.appendChild(b);
});
attendance_output.value=`Present: ${presentIDs.join(", ")}`;
}
document.getElementById("live-date").innerText=new Date().toDateString();
</script>

</body>
</html>
